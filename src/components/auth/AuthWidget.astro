<div
    id="auth-widget"
    class="fixed top-4 right-4 z-50 stone-panel p-2 rounded cursor-pointer hover:border-amber-600 transition-colors flex items-center gap-2"
>
    <span id="auth-status-text" class="font-gothic text-sm text-amber-500"
        >Login</span
    >
</div>

<script>
    import { authStore, logout } from "../../authStore.js";

    const authWidget = document.getElementById("auth-widget");
    const authStatusText = document.getElementById("auth-status-text");

    authWidget.addEventListener("click", () => {
        if (authStore.get().user) {
            if (confirm("Se dÃ©connecter ?")) logout();
        } else {
            if (window.showLoginModal) window.showLoginModal();
        }
    });

    authStore.subscribe((state) => {
        if (state.user) {
            authStatusText.textContent = `ðŸ‘¤ ${state.user.username}`;
            authStatusText.classList.replace(
                "text-amber-500",
                "text-emerald-400",
            );
        } else {
            authStatusText.textContent = `Login / Inscription`;
            authStatusText.classList.replace(
                "text-emerald-400",
                "text-amber-500",
            );
        }
    });
</script>
